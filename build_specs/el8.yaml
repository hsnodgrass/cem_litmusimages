---
FROM: "litmusimage/centos:8 AS baseimage"
ENTRYPOINT:
  - "/bin/bash"
package_install:
  command: "dnf -y install"
service_enable:
  command: "systemctl enable --now"
  startup_script: "/etc/rc.d/rc.local"
body:
  - RUN: "echo CRYPTO_POLICY= >> /etc/sysconfig/sshd"
  - package_install:
    - which
    - NetworkManager
    - nfs-utils
    - ypserv
    - postfix
    - cups
    - iptables-services
    - httpd
    - dovecot
    - vsftpd
    - samba
    - net-snmp
    - crypto-policies
    - xorg-x11-server-Xorg
    - rsync-daemon
    - avahi
    - passwd
  - service_enable:
    - NetworkManager
    - ypserv
    - postfix
    - cups
    - iptables
    - httpd
    - dovecot
    - vsftpd
    - smb
    - snmpd
    - rsyncd
    - avahi-daemon
  - FROM: "baseimage"
  - RUN:
    - 'useradd testuser1; echo -e "changeme\nchangeme" | (passwd --stdin testuser1)'
    - "sed -i 's/inet_interfaces = localhost/inet_interfaces = all/' /etc/postfix/main.cf"
    - "update-crypto-policies --set LEGACY && update-crypto-policies"
  
